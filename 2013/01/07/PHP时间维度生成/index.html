<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="PHP," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="生成时间维度Add.php 为生成入口设置里面的开始时间与结束时间（Unix时间戳）即可生成时间维度,写入MYSQL中。格式为：公历 - 公历短杠 - 公历反斜杠 - 短公历 - 阴历 - 第几天 - 第几周 - 周内第几天 - 数字年 - 数字月 - 数字季度 -中文年 - 中文月(数字) - 中文月 - 中文天 - 中文周 - 中文季度 - 月旬 - 半年 - 英文月 - 英文星期">
<meta name="keywords" content="PHP">
<meta property="og:type" content="article">
<meta property="og:title" content="PHP时间维度生成">
<meta property="og:url" content="http://toryzen.cn/2013/01/07/PHP时间维度生成/index.html">
<meta property="og:site_name" content="Toryzen&#39;s Blog">
<meta property="og:description" content="生成时间维度Add.php 为生成入口设置里面的开始时间与结束时间（Unix时间戳）即可生成时间维度,写入MYSQL中。格式为：公历 - 公历短杠 - 公历反斜杠 - 短公历 - 阴历 - 第几天 - 第几周 - 周内第几天 - 数字年 - 数字月 - 数字季度 -中文年 - 中文月(数字) - 中文月 - 中文天 - 中文周 - 中文季度 - 月旬 - 半年 - 英文月 - 英文星期">
<meta property="og:updated_time" content="2017-06-19T04:02:50.253Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PHP时间维度生成">
<meta name="twitter:description" content="生成时间维度Add.php 为生成入口设置里面的开始时间与结束时间（Unix时间戳）即可生成时间维度,写入MYSQL中。格式为：公历 - 公历短杠 - 公历反斜杠 - 短公历 - 阴历 - 第几天 - 第几周 - 周内第几天 - 数字年 - 数字月 - 数字季度 -中文年 - 中文月(数字) - 中文月 - 中文天 - 中文周 - 中文季度 - 月旬 - 半年 - 英文月 - 英文星期">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://toryzen.cn/2013/01/07/PHP时间维度生成/"/>





  <title>PHP时间维度生成 | Toryzen's Blog</title>
  












  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1262360703&web_id=1262360703" language="JavaScript"></script>
  </div>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Toryzen's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">爱技术,好产品,探管理</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/aboutme/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://toryzen.cn/2013/01/07/PHP时间维度生成/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="toryzen">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Toryzen's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">PHP时间维度生成</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-01-07T18:52:52+08:00">
                2013-01-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术之道/" itemprop="url" rel="index">
                    <span itemprop="name">技术之道</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>生成时间维度<br>Add.php 为生成入口<br>设置里面的开始时间与结束时间（Unix时间戳）即可生成时间维度,写入MYSQL中。<br>格式为：<br>公历 - 公历短杠 - 公历反斜杠 - 短公历 - 阴历 - 第几天 - 第几周 - 周内第几天 - 数字年 - 数字月 - 数字季度 -<br>中文年 - 中文月(数字) - 中文月 - 中文天 - 中文周 - 中文季度 - 月旬 - 半年 - 英文月 - 英文星期<br><a id="more"></a></p>
<p>[sql]<br>CREATE TABLE <code>timer</code> (<br>  <code>gregorian</code> varchar(10) character set utf8 NOT NULL COMMENT ‘公历’,<br>  <code>g_shortbars</code> varchar(10) character set utf8 NOT NULL COMMENT ‘公历短杠’,<br>  <code>g_backslash</code> varchar(10) character set utf8 NOT NULL COMMENT ‘公历反斜杠’,<br>  <code>g_short</code> varchar(10) character set utf8 NOT NULL COMMENT ‘短公历’,<br>  <code>lunar</code> varchar(10) character set utf8 NOT NULL COMMENT ‘阴历’,<br>  <code>dayofyear</code> int(11) NOT NULL COMMENT ‘第几天’,<br>  <code>weekofyear</code> int(11) NOT NULL COMMENT ‘第几周’,<br>  <code>dayofweek</code> int(11) NOT NULL COMMENT ‘周内第几天’,<br>  <code>year_num</code> int(11) NOT NULL COMMENT ‘数字年’,<br>  <code>month_num</code> int(11) NOT NULL COMMENT ‘数字月’,<br>  <code>day_num</code> int(11) NOT NULL COMMENT ‘数字天’,<br>  <code>season_num</code> int(11) NOT NULL COMMENT ‘数字季度’,<br>  <code>year_cn</code> varchar(10) character set utf8 NOT NULL COMMENT ‘中文年’,<br>  <code>month_cn</code> varchar(10) character set utf8 NOT NULL COMMENT ‘中文月(数字)’,<br>  <code>month_allcn</code> varchar(10) character set utf8 NOT NULL COMMENT ‘中文月’,<br>  <code>day_cn</code> varchar(10) character set utf8 NOT NULL COMMENT ‘中文天’,<br>  <code>week_cn</code> varchar(10) character set utf8 NOT NULL COMMENT ‘中文周’,<br>  <code>season_cn</code> varchar(10) character set utf8 NOT NULL COMMENT ‘中文季度’,<br>  <code>tendays</code> varchar(10) character set utf8 NOT NULL COMMENT ‘月旬’,<br>  <code>halfyear</code> varchar(10) character set utf8 NOT NULL COMMENT ‘半年’,<br>  <code>month_en</code> varchar(10) character set utf8 NOT NULL COMMENT ‘英文星期’,<br>  <code>week_en</code> varchar(10) character set utf8 NOT NULL COMMENT ‘英文星期’,<br>  PRIMARY KEY  (<code>gregorian</code>)<br>) ENGINE=InnoDB DEFAULT CHARSET=utf8;<br>[/sql]<br>[php]<br>&lt;?php<br>/*<br> +——————————————————————————</p>
<ul>
<li>时间维度生成<br>+——————————————————————————</li>
<li>@Framework  None</li>
<li>@Platform   None</li>
<li>@Author     ToryZen &lt;toryzen@gmail.com&gt;<br>+——————————————————————————<br>*/<br>ini_set(&quot;max_execution_time&quot;, &quot;180000&quot;);<br>include(‘Function.php’);<br>require_once ‘Lunar.php’;<br>$begintime = 1136131200;//开始时间20060101<br>$endtime = 1577808000;//结束时间20200101<br>$con = mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;&quot;);<br>mysql_select_db(&quot;NewTimter&quot;, $con);<br>mysql_query(‘set names utf8’);<br>for($begintime;$begintime&lt;=$endtime;$begintime+=86400){<pre><code>$gl = date(&apos;Ymd&apos;,$begintime);//公历
$gl_shortbars = date(&apos;Y-m-d&apos;,$begintime);//公历短斜杠
$gl_backslash = date(&apos;Y/m/d&apos;,$begintime);//公历反斜杠
$gl_short = date(&apos;ymd&apos;,$begintime);//短公历
$lunar = new Lunar();
$nl = date(&amp;quot;Ymd&amp;quot;,$lunar-&amp;gt;S2L(date(&amp;quot;Y-m-d&amp;quot;,$begintime))); //农历
$year_num = date(&apos;Y&apos;,$begintime);//数字年
$year_cn = $year_num.&amp;quot;年&amp;quot;;//中文年
$month_num = date(&apos;m&apos;,$begintime);//数字月
$month_cn = (int)($month_num).&amp;quot;月&amp;quot;;//中文月(数字)
$month_allcn = monthcn($month_num);//中文月
$day_num = date(&apos;d&apos;,$begintime);//数字天
$day_cn = (int)($day_num).&amp;quot;日&amp;quot;;//中文天
$week = week(date(&apos;D&apos;,$begintime));
$dayofweek = $week[num];//数字星期
$week_cn = $week[cn];//中文星期
$season = season($month_num);
$season_num = $season[num];//数字季度
$season_cn = $season[cn];//中文季度
$halfyear = halfyear($month_num);//半年
$tendays = tendays($day_num);//月旬
$month_en = date(&apos;M&apos;,$begintime);//英文月
$week_en = date(&apos;l&apos;,$begintime);//英文周
$dayofyear = date(&apos;z&apos;,$begintime)+1;//第几天
$weekofyear = date(&apos;W&apos;,$begintime);//第几周
//$dayofweek =  date(&apos;W&apos;,$begintime);//第几周
//echo $gl.&amp;quot;        &amp;quot;.$weekofyear.&amp;quot;&amp;lt;br/&amp;gt;&amp;quot;;
//echo $month_allcn.&amp;quot;&amp;lt;br&amp;gt;&amp;quot; ;
mysql_query(&amp;quot;INSERT INTO timer (gregorian,g_shortbars,g_backslash,g_short,lunar,dayofyear,weekofyear,dayofweek,year_num,month_num,day_num,season_num,year_cn,month_cn,month_allcn,day_cn,week_cn,season_cn,tendays,halfyear,month_en,week_en) VALUES (&apos;&amp;quot;.$gl.&amp;quot;&apos;,&apos;&amp;quot;.$gl_shortbars.&amp;quot;&apos;,&apos;&amp;quot;.$gl_backslash.&amp;quot;&apos;,&apos;&amp;quot;.$gl_short.&amp;quot;&apos;,&apos;&amp;quot;.$nl.&amp;quot;&apos;,&apos;&amp;quot;.$dayofyear.&amp;quot;&apos;,&apos;&amp;quot;.$weekofyear.&amp;quot;&apos;,&apos;&amp;quot;.$dayofweek.&amp;quot;&apos;,&apos;&amp;quot;.$year_num.&amp;quot;&apos;,&apos;&amp;quot;.$month_num.&amp;quot;&apos;,&apos;&amp;quot;.$day_num.&amp;quot;&apos;,&apos;&amp;quot;.$season_num.&amp;quot;&apos;,&apos;&amp;quot;.$year_cn.&amp;quot;&apos;,&apos;&amp;quot;.$month_cn.&amp;quot;&apos;,&apos;&amp;quot;.$month_allcn.&amp;quot;&apos;,&apos;&amp;quot;.$day_cn.&amp;quot;&apos;,&apos;&amp;quot;.$week_cn.&amp;quot;&apos;,&apos;&amp;quot;.$season_cn.&amp;quot;&apos;,&apos;&amp;quot;.$halfyear.&amp;quot;&apos;,&apos;&amp;quot;.$tendays.&amp;quot;&apos;,&apos;&amp;quot;.$month_en.&amp;quot;&apos;,&apos;&amp;quot;.$week_en.&amp;quot;&apos;)&amp;quot;,$con);
</code></pre>}<br>mysql_close($con);<br>?&gt;<br>[/php]<br>[php]<br>&lt;?php<br>/*<br>+——————————————————————————</li>
<li>时间维度方法<br>+——————————————————————————</li>
<li>@Framework  None</li>
<li>@Platform   None</li>
<li>@Author     ToryZen &lt;toryzen@gmail.com&gt;<br>+——————————————————————————<br>*/<br>function week($s){<br>//星期方法<pre><code>if($s==&apos;Sun&apos;){
        $r[num] = &apos;7&apos;;
        $r[cn] = &apos;星期天&apos;;
}
if($s==&apos;Mon&apos;){
        $r[num] = &apos;1&apos;;
        $r[cn] = &apos;星期一&apos;;
}
if($s==&apos;Tue&apos;){
        $r[num] = &apos;2&apos;;
        $r[cn] = &apos;星期二&apos;;
}
if($s==&apos;Wed&apos;){
        $r[num] = &apos;3&apos;;
        $r[cn] = &apos;星期三&apos;;
}
if($s==&apos;Thu&apos;){
        $r[num] = &apos;4&apos;;
        $r[cn] = &apos;星期四&apos;;
}
if($s==&apos;Fri&apos;){
        $r[num] = &apos;5&apos;;
        $r[cn] = &apos;星期天&apos;;
}
if($s==&apos;Sat&apos;){
        $r[num] = &apos;6&apos;;
        $r[cn] = &apos;星期六&apos;;
}
return $r;
</code></pre>}<br>function season($s){<br>//季度方法<pre><code>if($s==&apos;01&apos;||$s==&apos;02&apos;||$s==&apos;03&apos;||$s==&apos;04&apos;){
        $r[num] = &apos;1&apos;;
        $r[cn] = &apos;一季度&apos;;
}
if($s==&apos;05&apos;||$s==&apos;06&apos;||$s==&apos;07&apos;||$s==&apos;08&apos;){
        $r[num] = &apos;2&apos;;
        $r[cn] = &apos;二季度&apos;;
}
if($s==&apos;09&apos;||$s==&apos;10&apos;||$s==&apos;11&apos;||$s==&apos;12&apos;){
        $r[num] = &apos;3&apos;;
        $r[cn] = &apos;三季度&apos;;
}
return $r;
</code></pre>}<br>function halfyear($s){<br>//半年方法<pre><code>if($s==&apos;01&apos;||$s==&apos;2&apos;||$s==&apos;3&apos;||$s==&apos;4&apos;||$s==&apos;5&apos;||$s==&apos;6&apos;){
        $r = &apos;上半年&apos;;
}
else{
        $r = &apos;下半年&apos;;
}
return $r;
</code></pre>}<br>function tendays($s){<br>//月旬方法<pre><code>$s = (int)$s;
if($s&amp;lt;11){
        $r = &apos;上旬&apos;;
}
if($s&amp;lt;21&amp;amp;&amp;amp;$s&amp;gt;10){
        $r = &apos;中旬&apos;;
}
if($s&amp;gt;20){
        $r = &apos;下旬&apos;;
}
return $r;
</code></pre>}</li>
</ul>
<p>function monthcn($s){<br>        if($s==’01’){$r = ‘一月’;}<br>        if($s==’02’){$r = ‘二月’;}<br>        if($s==’03’){$r = ‘三月’;}<br>        if($s==’04’){$r = ‘四月’;}<br>        if($s==’05’){$r = ‘五月’;}<br>        if($s==’06’){$r = ‘六月’;}<br>        if($s==’07’){$r = ‘七月’;}<br>        if($s==’08’){$r = ‘八月’;}<br>        if($s==’09’){$r = ‘九月’;}<br>        if($s==’10’){$r = ‘十月’;}<br>        if($s==’11’){$r = ‘十一月’;}<br>        if($s==’12’){$r = ‘十二月’;}</p>
<pre><code>return $r;
</code></pre><p>}</p>
<p>?&gt;<br>[/php]<br>[php]<br>&lt;?php<br>class Lunar<br>{<br>        private  $_SMDay = array(1 =&gt; 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);//定义公历月分天数<br>        private  $_LStart = 1950 ;//农历从1950年开始<br>        private  $_LMDay = array(<br>        //差：该年的农历正月初一到该年公历1月1日的天数；1~12：农历月份天数；闰：如有闰月，记录该月平月天数<br>        //差  1  2  3  4  5  6  7  8  9 10 11 12 闰<br>        array(47,29,30,30,29,30,30,29,29,30,29,30,29),<br>        array(36,30,29,30,30,29,30,29,30,29,30,29,30),<br>    array(6,29,30,29,30,59,29,30,30,29,30,29,30,29),    //五月29 闰五月30<br>           array(44,29,30,29,29,30,30,29,30,30,29,30,29),<br>    array(33,30,29,30,29,29,30,29,30,30,29,30,30),<br>    array(23,29,30,59,29,29,30,29,30,29,30,30,30,29),    //三月29 闰三月30<br>    array(42,29,30,29,30,29,29,30,29,30,29,30,30),<br>    array(30,30,29,30,29,30,29,29,59,30,29,30,29,30),    //八月30 闰八月29<br>    array(48,30,30,30,29,30,29,29,30,29,30,29,30),<br>    array(38,29,30,30,29,30,29,30,29,30,29,30,29),<br>    array(27,30,29,30,29,30,59,30,29,30,29,30,29,30),    //六月30 闰六月29<br>    array(45,30,29,30,29,30,29,30,30,29,30,29,30),<br>    array(35,29,30,29,29,30,29,30,30,29,30,30,29),<br>    array(24,30,29,30,58,30,29,30,29,30,30,30,29,29),    //四月29 闰四月29<br>    array(43,30,29,30,29,29,30,29,30,29,30,30,30),<br>    array(32,29,30,29,30,29,29,30,29,29,30,30,29),<br>    array(20,30,30,59,30,29,29,30,29,29,30,30,29,30),    //三月30 闰三月29<br>    array(39,30,30,29,30,30,29,29,30,29,30,29,30),<br>    array(29,29,30,29,30,30,29,59,30,29,30,29,30,30),    //七月30 闰七月29<br>    array(47,29,30,29,30,29,30,30,29,30,29,30,29),<br>    array(36,30,29,29,30,29,30,30,29,30,30,29,30),<br>    array(26,29,30,29,29,59,30,29,30,30,30,29,30,30),    //五月30 闰五月29<br>    array(45,29,30,29,29,30,29,30,29,30,30,29,30),<br>    array(33,30,29,30,29,29,30,29,29,30,30,29,30),<br>    array(22,30,30,29,59,29,30,29,29,30,30,29,30,30),    //四月30 闰四月29<br>    array(41,30,30,29,30,29,29,30,29,29,30,29,30),<br>    array(30,30,30,29,30,29,30,29,59,29,30,29,30,30),    //八月30 闰八月29<br>    array(48,30,29,30,30,29,30,29,30,29,30,29,29),<br>    array(37,30,29,30,30,29,30,30,29,30,29,30,29),<br>    array(27,30,29,29,30,29,60,29,30,30,29,30,29,30),    //六月30 闰六月30<br>    array(46,30,29,29,30,29,30,29,30,30,29,30,30),<br>    array(35,29,30,29,29,30,29,29,30,30,29,30,30),<br>    array(24,30,29,30,58,30,29,29,30,29,30,30,30,29),    //四月29 闰四月29<br>    array(43,30,29,30,29,29,30,29,29,30,29,30,30),<br>    array(32,30,29,30,30,29,29,30,29,29,59,30,30,30),    //十月30 闰十月29<br>    array(50,29,30,30,29,30,29,30,29,29,30,29,30),<br>    array(39,29,30,30,29,30,30,29,30,29,30,29,29),<br>    array(28,30,29,30,29,30,59,30,30,29,30,29,29,30),    //六月30 闰六月29<br>    array(47,30,29,30,29,30,29,30,30,29,30,30,29),<br>    array(36,30,29,29,30,29,30,29,30,29,30,30,30),<br>    array(26,29,30,29,29,59,29,30,29,30,30,30,30,30),    //五月30 闰五月29<br>    array(45,29,30,29,29,30,29,29,30,29,30,30,30),<br>    array(34,29,30,30,29,29,30,29,29,30,29,30,30),<br>    array(22,29,30,59,30,29,30,29,29,30,29,30,29,30),    //三月30 闰三月29<br>    array(40,30,30,30,29,30,29,30,29,29,30,29,30),<br>    array(30,29,30,30,29,30,29,30,59,29,30,29,30,30),    //八月30 闰八月29<br>    array(49,29,30,29,30,30,29,30,29,30,30,29,29),<br>    array(37,30,29,30,29,30,29,30,30,29,30,30,29),<br>    array(27,30,29,29,30,58,30,30,29,30,30,29,30,29),    //五月29 闰五月29<br>    array(46,30,29,29,30,29,29,30,29,30,30,30,29),<br>    array(35,30,30,29,29,30,29,29,30,29,30,30,29),<br>    array(23,30,30,29,59,30,29,29,30,29,30,29,30,30),    //四月30 闰四月29<br>    array(42,30,30,29,30,29,30,29,29,30,29,30,29),<br>    array(31,30,30,29,30,30,29,30,29,29,30,29,30),<br>    array(21,29,59,30,30,29,30,29,30,29,30,29,30,30),    //二月30 闰二月29<br>    array(39,29,30,29,30,29,30,30,29,30,29,30,29),<br>    array(28,30,29,30,29,30,29,59,30,30,29,30,30,30),    //七月30 闰七月29<br>    array(48,29,29,30,29,29,30,29,30,30,30,29,30),<br>    array(37,30,29,29,30,29,29,30,29,30,30,29,30),<br>    array(25,30,30,29,29,59,29,30,29,30,29,30,30,30),    //五月30 闰五月29<br>    array(44,30,29,30,29,30,29,29,30,29,30,29,30),<br>    array(33,30,29,30,30,29,30,29,29,30,29,30,29),<br>    array(22,30,29,30,59,30,29,30,29,30,29,30,29,30),    //四月30 闰四月29<br>    array(40,30,29,30,29,30,30,29,30,29,30,29,30),<br>    array(30,29,30,29,30,29,30,29,30,59,30,29,30,30),    //九月30 闰九月29<br>    array(49,29,30,29,29,30,29,30,30,30,29,30,29),<br>    array(38,30,29,30,29,29,30,29,30,30,29,30,30),<br>    array(27,29,30,29,30,29,59,29,30,29,30,30,30,29),    //六月29 闰六月30<br>    array(46,29,30,29,30,29,29,30,29,30,29,30,30),<br>    array(35,30,29,30,29,30,29,29,30,29,29,30,30),<br>    array(24,29,30,30,59,30,29,29,30,29,30,29,30,30),    //四月30 闰四月29<br>    array(42,29,30,30,29,30,29,30,29,30,29,30,29),<br>    array(31,30,29,30,29,30,30,29,30,29,30,29,30),<br>    array(21,29,59,29,30,30,29,30,30,29,30,29,30,30),    //二月30 闰二月29<br>    array(40,29,30,29,29,30,29,30,30,29,30,30,29),<br>    array(28,30,29,30,29,29,59,30,29,30,30,30,29,30),    //六月30 闰六月29<br>    array(47,30,29,30,29,29,30,29,29,30,30,30,29),<br>    array(36,30,30,29,30,29,29,30,29,29,30,30,29),<br>    array(25,30,30,30,29,59,29,30,29,29,30,30,29,30),    //五月30 闰五月29<br>    array(43,30,30,29,30,29,30,29,30,29,29,30,30),<br>    array(33,29,30,29,30,30,29,30,29,30,29,30,29),<br>    array(22,29,30,59,30,29,30,30,29,30,29,30,29,30),    //三月30 闰三月29<br>    array(41,30,29,29,30,29,30,30,29,30,30,29,30),<br>    array(30,29,30,29,29,30,29,30,29,30,30,59,30,30),    //十一月30 闰十一月29<br>    array(49,29,30,29,29,30,29,30,29,30,30,29,30),<br>    array(38,30,29,30,29,29,30,29,29,30,30,29,30),<br>    array(27,30,30,29,30,29,59,29,29,30,29,30,30,29),    //六月29 闰六月30<br>    array(45,30,30,29,30,29,29,30,29,29,30,29,30),<br>    array(34,30,30,29,30,29,30,29,30,29,29,30,29),<br>    array(23,30,30,29,30,59,30,29,30,29,30,29,29,30),    //五月30 闰五月29<br>    array(42,30,29,30,30,29,30,29,30,30,29,30,29),<br>    array(31,29,30,29,30,29,30,30,29,30,30,29,30),<br>    array(21,29,59,29,30,29,30,29,30,30,29,30,30,30),    //二月30 闰二月29<br>    array(40,29,30,29,29,30,29,29,30,30,29,30,30),<br>    array(29,30,29,30,29,29,30,58,30,29,30,30,30,29),    //七月29 闰七月29<br>    array(47,30,29,30,29,29,30,29,29,30,29,30,30),<br>    array(36,30,29,30,29,30,29,30,29,29,30,29,30),<br>    array(25,30,29,30,30,59,29,30,29,29,30,29,30,29),    //五月29 闰五月30<br>    array(44,29,30,30,29,30,30,29,30,29,29,30,29),<br>    array(32,30,29,30,29,30,30,29,30,30,29,30,29),<br>    array(22,29,30,59,29,30,29,30,30,29,30,30,29,29),    //三月29 闰三月30<br>        );<br>        //是否闰年<br>        private function IsLeapYear($AYear){<br>        return ($AYear % 4 == 0) &amp;&amp; (($AYear % 100 != 0) || ($AYear % 400 == 0));<br>        }<br>        //公历该月的天数(year：年份； month：月份)<br>        private function GetSMon($year,$month)<br>        {<br>                if($this-&gt;IsLeapYear($year) &amp;&amp; $month == 2)<br>                        return 29;<br>                else<br>                        return $this-&gt;_SMDay[$month];<br>        }<br>        //农历名称转换<br>        private function LYearName($year)<br>        {<br>                $Name = array(&quot;零&quot;,&quot;一&quot;,&quot;二&quot;,&quot;三&quot;,&quot;四&quot;,&quot;五&quot;,&quot;六&quot;,&quot;七&quot;,&quot;八&quot;,&quot;九&quot;);<br>                for($i=0;$i&lt;4;$i++)<br>                        for($k=0;$k&lt;10;$k++)<br>                                if($year[$i]==$k)<br>                                        $tmp.=$Name[$k];<br>                return $tmp;<br>        }</p>
<pre><code>private function LMonName($month)
{
        if($month &amp;gt;=1 &amp;amp;&amp;amp; $month &amp;lt;=12 )
        {
                $Name = array( 1=&amp;gt;&amp;quot;正&amp;quot;,&amp;quot;二&amp;quot;,&amp;quot;三&amp;quot;,&amp;quot;四&amp;quot;,&amp;quot;五&amp;quot;,&amp;quot;六&amp;quot;,&amp;quot;七&amp;quot;,&amp;quot;八&amp;quot;,&amp;quot;九&amp;quot;,&amp;quot;十&amp;quot;,&amp;quot;十一&amp;quot;,&amp;quot;十二&amp;quot;);
                return $Name[$month];
        }
        return $month;
}

private function LDayName($day)
{
        if($day &amp;gt;=1 &amp;amp;&amp;amp; $day &amp;lt;=30 )
        {
                $Name = array( 1 =&amp;gt;
                &amp;quot;初一&amp;quot;,&amp;quot;初二&amp;quot;,&amp;quot;初三&amp;quot;,&amp;quot;初四&amp;quot;,&amp;quot;初五&amp;quot;,&amp;quot;初六&amp;quot;,&amp;quot;初七&amp;quot;,&amp;quot;初八&amp;quot;,&amp;quot;初九&amp;quot;,&amp;quot;初十&amp;quot;,
                &amp;quot;十一&amp;quot;,&amp;quot;十二&amp;quot;,&amp;quot;十三&amp;quot;,&amp;quot;十四&amp;quot;,&amp;quot;十五&amp;quot;,&amp;quot;十六&amp;quot;,&amp;quot;十七&amp;quot;,&amp;quot;十八&amp;quot;,&amp;quot;十九&amp;quot;,&amp;quot;二十&amp;quot;,
                &amp;quot;廿一&amp;quot;,&amp;quot;廿二&amp;quot;,&amp;quot;廿三&amp;quot;,&amp;quot;廿四&amp;quot;,&amp;quot;廿五&amp;quot;,&amp;quot;廿六&amp;quot;,&amp;quot;廿七&amp;quot;,&amp;quot;廿八&amp;quot;,&amp;quot;廿九&amp;quot;,&amp;quot;三十&amp;quot;
                );
                return $Name[$day];
        }
        return $day;
}

//公历转农历(Sdate：公历日期)
public function S2L($date)
{
        list($year, $month, $day) = explode(&amp;quot;-&amp;quot;, $date);
        if($year &amp;lt;= 1951 || $month &amp;lt;= 0 || $day &amp;lt;= 0 || $year &amp;gt;= 2051 )        return false;
        //获取查询日期到当年1月1日的天数
        $date1 = strtotime($year.&amp;quot;-01-01&amp;quot;);//当年1月1日
        $date2 = strtotime($year.&amp;quot;-&amp;quot;.$month.&amp;quot;-&amp;quot;.$day);
        $days=round(($date2-$date1)/3600/24);
        $days += 1;
        //获取相应年度农历数据，化成数组Larray
        $Larray = $this-&amp;gt;_LMDay[$year - $this-&amp;gt;_LStart];
        if($days &amp;lt;= $Larray[0])
        {
                $Lyear = $year - 1;
                $days = $Larray[0] - $days;
                $Larray = $this-&amp;gt;_LMDay[$Lyear - $this-&amp;gt;_LStart];
                if($days &amp;lt; $Larray[12])
                {
                        $Lmonth = 12;
                        $Lday = $Larray[12] - $days;
                }
                else
                {
                        $Lmonth = 11;
                        $days = $days - $Larray[12];
                        $Lday = $Larray[11] - $days;
                }
        }
        else
        {
                $Lyear = $year;
                $days = $days - $Larray[0];
                for($i = 1;$i &amp;lt;= 12;$i++)
                {
                        if($days &amp;gt; $Larray[$i]) $days = $days - $Larray[$i];
                        else
                        {
                                if ($days &amp;gt; 30){
                                        $days = $days - $Larray[13];
                                        $Ltype = 1;
                                }

                                $Lmonth = $i;
                                $Lday = $days;
                                break;
                        }
                }
        }
        return mktime(0, 0, 0, $Lmonth, $Lday, $Lyear);
        //$Ldate = $Lyear.&amp;quot;-&amp;quot;.$Lmonth.&amp;quot;-&amp;quot;.$Lday;
        //$Ldate = $this-&amp;gt;LYearName($Lyear).&amp;quot;年&amp;quot;.$this-&amp;gt;LMonName($Lmonth).&amp;quot;月&amp;quot;.$this-&amp;gt;LDayName($Lday);
        //if($Ltype) $Ldate.=&amp;quot;(闰)&amp;quot;;
        //return $Ldate;
}
//农历转公历(date：农历日期； type：是否闰月)
public function L2S($date,$type = 0)
{
        list($year, $month, $day) = split(&amp;quot;-&amp;quot;,$date);
        if($year &amp;lt;= 1951 || $month &amp;lt;= 0 || $day &amp;lt;= 0 || $year &amp;gt;= 2051 )        return false;
        $Larray = $this-&amp;gt;_LMDay[$year - $this-&amp;gt;_LStart];
        if($type == 1 &amp;amp;&amp;amp; count($Larray)&amp;lt;=12 ) return false;//要求查询闰，但查无闰月
        //如果查询的农历是闰月并该年度农历数组存在闰月数据就获取
        if($Larray[$month]&amp;gt;30 &amp;amp;&amp;amp; $type == 1 &amp;amp;&amp;amp; count($Larray) &amp;gt;=13)        $day = $Larray[13] + $day;
        //获取该年农历日期到公历1月1日的天数
        $days = $day;
        for($i=0;$i&amp;lt;=$month-1;$i++)
                $days += $Larray[$i];
        //当查询农历日期距离公历1月1日超过一年时
        if($days &amp;gt; 366 || ($this-&amp;gt;GetSMon($month,2)!=29 &amp;amp;&amp;amp; $days&amp;gt;365 ))
        {
                $Syear = $year +1;
                if($this-&amp;gt;GetSMon($month,2)!=29)
                        $days-=366;
                else
                        $days-=365;
                if($days &amp;gt; $this-&amp;gt;_SMDay[1])
                {
                        $Smonth = 2;
                        $Sday = $days - $this-&amp;gt;_SMDay[1];
                }
                else
                {
                        $Smonth = 1;
                        $Sday = $days;
                }
        }
        else
        {
                $Syear =$year;
                for($i=1;$i&amp;lt;=12;$i++)
                {
                        if($days &amp;gt; $this-&amp;gt;GetSMon($Syear,$i))
                                $days-=$this-&amp;gt;GetSMon($Syear,$i);
                        else
                        {
                                $Smonth = $i;
                                $Sday = $days;
                                break;
                        }
                }
        }
        return mktime(0, 0, 0, $Smonth, $Sday, $Syear);
        //$Sdate = $Syear.&amp;quot;-&amp;quot;.$Smonth.&amp;quot;-&amp;quot;.$Sday;
        //return $Sdate;
}
</code></pre><p>}<br>?&gt;<br>[/php]</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/PHP/" rel="tag"># PHP</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2013/01/01/2012大总结,2013大畅想/" rel="next" title="2012大总结,2013大畅想...">
                <i class="fa fa-chevron-left"></i> 2012大总结,2013大畅想...
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2013/03/05/Python抓取Torrentkitty磁力链/" rel="prev" title="Python抓取Torrentkitty磁力链">
                Python抓取Torrentkitty磁力链 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox">
  <script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=576" async = "async" ></script>
</div>

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="uyan_frame"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="toryzen" />
          <p class="site-author-name" itemprop="name">toryzen</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">73</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">42</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://github.com/toryzen" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/toryzen" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://twitter.com/toryzen" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/toryzen" target="_blank" title="Zhihu">
                  
                    <i class="fa fa-fw fa-quora"></i>
                  
                  Zhihu
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:36927999@qq.com" target="_blank" title="Email">
                  
                    <i class="fa fa-fw fa-address-card"></i>
                  
                  Email
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">toryzen</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  
    

    
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=576"></script>
      <!-- UY END -->
    
  





  






  





  

  

  

  

  

  

</body>
</html>
